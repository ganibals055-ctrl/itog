// –ü–∞–π–ø–ª–∞–π–Ω –¥–ª—è .NET —Å–µ—Ä–≤–∏—Å–∞ (–æ—Ü–µ–Ω–∫–∏)
pipeline {
    agent any
    stages {
        stage('Checkout SCM') {
            steps { echo 'üì• –ö–ª–æ–Ω–∏—Ä—É—é –∫–æ–¥ .NET —Å–µ—Ä–≤–∏—Å–∞' }
        }
        stage('Docker Build') {
            steps {
                echo 'üê≥ –°–æ–±–∏—Ä–∞—é Docker –æ–±—Ä–∞–∑ .NET —Å–µ—Ä–≤–∏—Å–∞'
                sh 'docker build -t localhost:19092/dotnet-rating-service:latest .'
            }
        }
        stage('Push to Nexus') {
            steps {
                echo 'üì§ –û—Ç–ø—Ä–∞–≤–ª—è—é –æ–±—Ä–∞–∑ –≤ Nexus'
                sh '''
                  docker login localhost:19092 -u admin -p admin123
                  docker push localhost:19092/dotnet-rating-service:latest
                '''
            }
        }
        stage('Deploy to K8s') {
            steps {
                echo 'üöÄ –î–µ–ø–ª–æ—é –≤ Kubernetes'
                sh 'echo "kubectl apply -f deployment.yaml"'
            }
        }
    }
    post { 
        always { echo 'üßπ –û—á–∏—â–∞—é workspace' }
        success { echo '‚úÖ .NET –ü–ê–ô–ü–õ–ê–ô–ù –í–´–ü–û–õ–ù–ï–ù!' }
    }
}